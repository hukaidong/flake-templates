\documentclass[aspectratio=169, 8pt]{beamer}

% Gotham theme - A modern, clean Beamer theme
\usetheme{gotham}

% Gotham theme configuration
\gothamset{
	numbering=framenumber,          % Show frame numbers
	parttocframe default=off,       % Disable part TOC frames
	sectiontocframe default=off,    % Disable section TOC frames
	subsectiontocframe default=off, % Disable subsection TOC frames
}

% Essential packages
\usepackage{standalone}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{tabularray}
	\UseTblrLibrary{booktabs}
\usepackage{changepage}
\usepackage{appendixnumberbeamer}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}

% ===================================================================
% \rplotfile macro - Automatically generate plots from R scripts
% ===================================================================
% This macro runs an R script to generate a PDF plot, then includes it.
% It intelligently only regenerates the plot if the R script is newer
% than the existing PDF, making builds efficient.
%
% Usage:
%   \rplotfile[includegraphics options]{output-pdf-name}{path/to/script.R}
%
% Example:
%   \rplotfile[width=0.8\textwidth]{myplot}{rplot/myplot.R}
%
% Requirements:
%   - R must be available in the build environment
%   - LaTeX must be compiled with -shell-escape flag (enabled by default)
%   - R script must save output as PDF with the specified name
% ===================================================================
\newcommand{\rplotfile}[3][]{%
  % #1 = all includegraphics options (optional, empty default)
  % #2 = output PDF name (without extension)
  % #3 = R script path
  \IfFileExists{#2.pdf}{%
    % If PDF exists, regenerate only if R script is newer
    \immediate\write18{test #3 -nt #2.pdf && Rscript #3 || true}%
  }{%
    % If PDF doesn't exist, generate it
    \immediate\write18{Rscript #3}%
  }%
  % Include the generated plot with optional parameters
  \ifx&#1&%
    \includegraphics{#2}%  % No options
  \else%
    \includegraphics[#1]{#2}%  % With options
  \fi%
}

% Optional: Define custom colors for your plots
\definecolor{signalcolor}{RGB}{100,180,100}
\definecolor{noisecolor}{RGB}{180,100,100}

% ===================================================================
% Presentation metadata
% ===================================================================
\title[Short Title]{Your Presentation Title}
\subtitle{Optional Subtitle}
\date[\today]{\today}
\author[Short Author]{Your Name}
\institute{Your Institution or Group}

\begin{document}

% Title slide
\maketitle

% ===================================================================
% Example slides demonstrating the template features
% ===================================================================

\begin{frame}{Welcome to the Gotham Beamer Template}
	\framesubtitle{A battery-included template with R plotting support}
	
	This template provides:
	
	\begin{itemize}
		\item Modern Gotham theme with clean aesthetics
		\item Automatic R plot generation with \texttt{\textbackslash rplotfile} macro
		\item Pre-configured packages for math, tables, and graphics
		\item Nix flake for reproducible builds
		\item Support for 16:9 aspect ratio presentations
	\end{itemize}
	
	\vspace{1em}
	
	\textbf{Getting started:}
	\begin{enumerate}
		\item Edit this \texttt{presentation.tex} file
		\item Add R scripts to the \texttt{rplot/} directory
		\item Build with \texttt{nix build}
	\end{enumerate}
\end{frame}

\begin{frame}{Using the \texttt{\textbackslash rplotfile} Macro}
	\framesubtitle{Automatic plot generation from R scripts}
	
	\textbf{How it works:}
	
	\begin{enumerate}
		\item Create an R script in \texttt{rplot/}
		\item Script saves plot as PDF
		\item Use \texttt{\textbackslash rplotfile} to include it
		\item Plot auto-regenerates when script changes
	\end{enumerate}
	
	\vspace{1em}
	
	\begin{columns}[T]
		\column{0.50\textwidth}
		
		\textbf{Example usage:}
		
		\small
		\texttt{\textbackslash rplotfile[width=0.7\textbackslash textwidth]}
		
		\texttt{\phantom{xx}\{example-plot\}}
		
		\texttt{\phantom{xx}\{rplot/example-plot.R\}}
		
		\column{0.46\textwidth}
		
		% Demo: Include the example R plot
		\begin{center}
			\rplotfile[width=\textwidth]{example-plot}{rplot/example-plot.R}
		\end{center}
		
	\end{columns}
	
	\vspace{0.5em}
	\small
	This plot was generated by \texttt{rplot/example-plot.R}
	
\end{frame}

\begin{frame}{Math and Tables Support}
	\framesubtitle{Pre-configured packages for scientific presentations}
	
	\begin{columns}[T]
		\column{0.48\textwidth}
		
		\textbf{Math with amsmath:}
		
		Inline math: $E = mc^2$
		
		\vspace{0.5em}
		
		Display math:
		\[
		\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}
		\]
		
		Aligned equations:
		\begin{align}
		f(x) &= x^2 + 2x + 1 \\
		     &= (x + 1)^2
		\end{align}
		
		\column{0.48\textwidth}
		
		\textbf{Tables with tabularray:}
		
		\begin{tblr}{
			colspec = {l r r},
			row{1} = {font=\bfseries},
		}
			\toprule
			Item & Value & Unit \\
			\midrule
			Parameter A & 42 & m/s \\
			Parameter B & 3.14 & rad \\
			Parameter C & 2.71 & -- \\
			\bottomrule
		\end{tblr}
		
	\end{columns}
\end{frame}

\begin{frame}{Next Steps}
	\framesubtitle{Customize this template for your needs}
	
	\textbf{To use this template:}
	
	\begin{enumerate}
		\item Replace the example content with your own slides
		\item Add your R plotting scripts to \texttt{rplot/}
		\item Customize colors, fonts, and theme settings as needed
		\item Build with \texttt{nix build} or develop with \texttt{nix develop}
	\end{enumerate}
	
	\vspace{1em}
	
	\textbf{Useful resources:}
	\begin{itemize}
		\item Gotham theme documentation: \texttt{texdoc beamertheme-gotham}
		\item Beamer user guide: \texttt{texdoc beamer}
		\item Tabularray manual: \texttt{texdoc tabularray}
	\end{itemize}
	
	\vspace{1em}
	
	\begin{center}
		\Large
		\textbf{Happy presenting!}
	\end{center}
\end{frame}

\end{document}
